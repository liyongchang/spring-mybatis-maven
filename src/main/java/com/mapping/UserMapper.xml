<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mapping.UserMapper">
    <resultMap id="UserResultMap" type="com.domain.User">
        <id column="uid" jdbcType="INTEGER" property="uid"/>
        <result column="username" jdbcType="VARCHAR" property="username"/>
        <result column="password" jdbcType="VARCHAR" property="password"/>
        <result column="name" jdbcType="VARCHAR" property="name"/>
        <result column="email" jdbcType="VARCHAR" property="email"/>
        <result column="phone" jdbcType="VARCHAR" property="phone"/>
        <result column="addr" jdbcType="VARCHAR" property="addr"/>
        <result column="state" jdbcType="INTEGER" property="state"/>
        <result column="code" jdbcType="VARCHAR" property="code"/>
        <collection property="orders" ofType="com.domain.Orders" column="uid">
            <id column="oid" property="oid" jdbcType="INTEGER" />
            <result column="total" property="total" jdbcType="DOUBLE" />
            <result column="ordertime" property="ordertime" jdbcType="TIMESTAMP" />
            <result column="state" property="state" jdbcType="INTEGER" />
            <result column="name" property="name" jdbcType="VARCHAR" />
            <result column="phone" property="phone" jdbcType="VARCHAR" />
            <result column="addr" property="addr" jdbcType="VARCHAR" />
            <result column="uid" property="uid" jdbcType="INTEGER" />
        </collection>
    </resultMap>



    <sql id="userColumns"> ${alias}.id,${alias}.username,${alias}.password </sql>

    <select id="selectUsers" resultType="map">
        select
        <include refid="userColumns">
            <property name="alias" value="t1"/>
        </include>
        ,
        <include refid="userColumns">
            <property name="alias" value="t2"/>
        </include>
        from some_table t1
        cross join some_table t2
    </select>

    <select id="queryUserById" resultType="com.domain.User" parameterType="INTEGER">
    SELECT
    *
    FROM USER
    WHERE UID = #{id}
  </select>

    <insert id="insertUser" useGeneratedKeys="true"
            keyProperty="uid">
    insert into User (username,password,email)
    values (#{username},#{password},#{email})
  </insert>

    <update id="updateUser">
    update User set
    username = #{username},
    password = #{password},
    email = #{email},
    bio = #{bio}
    where id = #{id}
  </update>

    <delete id="deleteUser">
    delete from User where id = #{id}
  </delete>

    <!--SELECT  * FROM user u,orders o WHERE  u.uid=o.uid and u.uid=7-->


    <select id="selectPersonFetchOrder" parameterType="int" resultMap="UserResultMap">
    select u.*,o.* from USER u,ORDERS o where o.uid=u.uid and u.uid=#{id}
  </select>


</mapper>